desc: 包括的なエラーハンドリング
runners:
  httpbin: http://localhost:8080

vars:
  max_retries: 3

steps:
  # HTTPステータスコードによるリトライ処理
  - desc: エラーをリトライで処理
    loop:
      count: 3
      until: |
        current.res.status == 200 ||
        current.res.status == 404  // 404は正常な結果として扱う
      minInterval: 1s
      maxInterval: 2s
    httpbin:
      /status/200,500,503:  # ランダムにステータスを返す
        get:
          body:
    test: |
      current.res.status in [200, 404, 500, 503]
    dump: |
      {
        "attempt": i + 1,
        "status": current.res.status,
        "is_success": current.res.status in [200, 404]
      }